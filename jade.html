<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jade et le Royaume du Goûter</title>
    <!-- Importation des polices Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&family=Comic+Neue:wght@400;700&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Styles généraux */
        :root {
            --color-light-blue: #D6EAF8; /* Bleu ciel doux */
            --color-light-pink: #FADBD8; /* Rose doux */
            --color-light-green: #D1F2EB; /* Vert menthe doux */
            --color-purple: #BB8FCE; /* Violet doux */
            --color-yellow: #F7DC6F; /* Jaune doux */
            --color-text-dark: #34495E; /* Bleu-gris foncé pour le texte */
            --color-text-light: #ECF0F1; /* Blanc cassé pour le texte sur fond foncé */
            --border-radius-large: 25px;
            --border-radius-medium: 15px;
            --box-shadow-light: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--color-light-blue) 0%, var(--color-light-green) 100%);
            color: var(--color-text-dark);
            line-height: 1.6;
            scroll-behavior: smooth;
            overflow-x: hidden; /* Empêche le défilement horizontal */
        }

        header, section, footer {
            padding: 40px 20px;
            margin: 20px auto;
            max-width: 1000px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius-large);
            box-shadow: var(--box-shadow-light);
            text-align: center;
        }

        h1, h2, h3, h4 {
            font-family: 'Poppins', sans-serif;
            color: var(--color-purple);
            margin-bottom: 20px;
        }

        h1 {
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        h2 {
            font-size: 2.2em;
            color: var(--color-text-dark);
        }

        h3 {
            font-size: 1.8em;
            color: var(--color-purple);
        }

        h4 {
            font-size: 1.5em;
            color: var(--color-text-dark);
        }

        p {
            font-size: 1.1em;
            margin-bottom: 15px;
        }

        .button {
            display: inline-block;
            padding: 15px 30px;
            margin: 10px;
            background-color: var(--color-purple);
            color: var(--color-text-light);
            text-decoration: none;
            border-radius: var(--border-radius-large);
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: var(--box-shadow-light);
            border: none;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-size: 1.1em;
        }

        .button:hover {
            background-color: #A569BD; /* Nuance plus foncée de violet */
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        /* Accueil */
        #accueil {
            position: relative;
            min-height: 80vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .dragon-svg {
            width: 150px;
            height: 150px;
            margin-bottom: 20px;
            animation: bounce 2s infinite ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        #catchphrase-container {
            font-family: 'Comic Neue', cursive;
            font-size: 1.8em;
            margin-top: 20px;
            min-height: 60px; /* Pour éviter le CLS */
            overflow: hidden; /* Empêche le texte de déborder pendant l'animation */
        }

        #catchphrase span {
            opacity: 0;
            display: inline-block;
            animation: revealText 0.8s forwards;
            animation-delay: var(--delay);
        }

        @keyframes revealText {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .navigation-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }

        .nav-button {
            background-color: var(--color-light-pink);
            color: var(--color-purple);
            border: 2px solid var(--color-purple);
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .nav-button:hover {
            background-color: var(--color-purple);
            color: var(--color-text-light);
            border-color: var(--color-light-pink);
        }

        /* Section Tri Sélectif */
        #tri-selectif-alimentaire .content-blocks {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 30px;
        }

        #tri-selectif-alimentaire .block {
            flex: 1;
            min-width: 300px;
            background-color: var(--color-light-blue);
            padding: 25px;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--box-shadow-light);
            text-align: left;
        }

        #tri-selectif-alimentaire .block.enfant { background-color: var(--color-light-pink); }
        #tri-selectif-alimentaire .block.parent { background-color: var(--color-yellow); }

        .audio-button {
            background-color: var(--color-purple);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            margin-left: 10px;
            cursor: pointer;
            border: none;
            box-shadow: var(--box-shadow-light);
            transition: background-color 0.3s ease;
        }

        .audio-button:hover {
            background-color: #A569BD;
        }

        /* Tableau Magique */
        #tableau-magique-jade {
            overflow-x: auto; /* Permet le défilement horizontal sur petits écrans */
        }

        #progress-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px; /* Espace entre les lignes */
            margin-top: 30px;
            background-color: var(--color-text-light);
            border-radius: var(--border-radius-medium);
            box-shadow: var(--box-shadow-light);
        }

        #progress-table th, #progress-table td {
            padding: 15px;
            border: none; /* Supprime les bordures par défaut */
            text-align: center;
        }

        #progress-table thead th {
            background-color: var(--color-purple);
            color: white;
            font-family: 'Comic Neue', cursive;
            font-size: 1.2em;
        }

        #progress-table tbody td {
            background-color: var(--color-light-blue);
            color: var(--color-text-dark);
        }

        #progress-table th:first-child, #progress-table td:first-child {
            text-align: left;
            font-weight: bold;
            background-color: var(--color-light-pink);
            border-top-left-radius: var(--border-radius-medium);
            border-bottom-left-radius: var(--border-radius-medium);
        }

        #progress-table th:last-child, #progress-table td:last-child {
            border-top-right-radius: var(--border-radius-medium);
            border-bottom-right-radius: var(--border-radius-medium);
        }


        #progress-table td button {
            background: none;
            border: none;
            font-size: 2em;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            padding: 0;
            line-height: 1; /* Supprime l'espace supplémentaire */
        }

        #progress-table td button.active {
            transform: scale(1.2) rotate(10deg);
            filter: drop-shadow(0 0 5px var(--color-yellow));
        }

        .progress-indicator {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .animation-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            overflow: hidden;
            z-index: 1000;
            display: none; /* Caché par défaut */
        }

        .star {
            position: absolute;
            font-size: 3em;
            color: var(--color-yellow);
            text-shadow: 0 0 10px var(--color-yellow);
            animation: starFall 3s forwards ease-out;
            opacity: 0;
        }

        @keyframes starFall {
            0% { opacity: 0; transform: translate(0, -100px) rotate(0deg); }
            20% { opacity: 1; }
            100% { opacity: 0; transform: translate(var(--end-x), var(--end-y)) rotate(720deg); }
        }

        /* Missions Croquilou */
        #missions-croquilou .mission-display {
            background-color: var(--color-light-blue);
            padding: 25px;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--box-shadow-light);
            margin-bottom: 20px;
            min-height: 80px; /* Empêche le CLS */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4em;
            font-family: 'Comic Neue', cursive;
        }

        #missions-croquilou .gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            min-height: 80px; /* Empêche le CLS */
        }

        .badge {
            font-size: 3em;
            opacity: 0;
            animation: fadeIn 0.5s forwards;
            animation-delay: var(--delay);
            filter: drop-shadow(0 0 5px rgba(0,0,0,0.2));
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Section Jade Spéciale (pour organiser le contenu enfant) */
        .jade-section-content {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius-large);
            box-shadow: var(--box-shadow-light);
            padding: 40px 20px;
            margin: 20px auto;
            max-width: 1000px;
            text-align: center;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
            justify-items: center;
        }

        .food-item {
            background-color: var(--color-light-pink);
            border-radius: var(--border-radius-medium);
            padding: 15px;
            box-shadow: var(--box-shadow-light);
            text-align: center;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            transition: transform 0.2s ease;
            cursor: pointer; /* To indicate clickability */
        }

        .food-item:hover {
            transform: translateY(-5px);
        }

        .food-item .emoji {
            font-size: 3em;
        }

        .food-item p {
            margin: 0;
            font-size: 1em;
        }


        /* Section Morgane */
        #conseils-maman {
            text-align: left;
            /* REMOVED: display: none; */ /* Its display will be controlled by #morgane-content parent */
        }

        #conseils-maman .intro-text {
            font-style: italic;
            margin-bottom: 30px;
            color: var(--color-purple);
        }

        #conseils-maman .action-plan ul {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        #conseils-maman .action-plan li {
            background-color: var(--color-light-green);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: var(--border-radius-medium);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        #conseils-maman .action-plan li::before {
            content: '✔️';
            font-size: 1.2em;
            line-height: 1;
        }

        .citation {
            font-family: 'Comic Neue', cursive;
            font-style: italic;
            margin-top: 20px;
            padding: 15px;
            background-color: var(--color-light-pink);
            border-left: 5px solid var(--color-purple);
            border-radius: var(--border-radius-medium);
        }

        .conseil-block {
            background-color: var(--color-light-blue);
            padding: 20px;
            border-radius: var(--border-radius-medium);
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .conseil-block h4 {
            color: var(--color-text-dark);
            margin-top: 0;
            font-size: 1.5em;
        }
        .conseil-block ul {
            list-style-type: disc;
            padding-left: 20px;
            text-align: left;
        }

        /* Zone de Récompense */
        #zone-recompense .gallery {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .reward-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            font-size: 1.2em;
            background-color: var(--color-light-blue);
            padding: 15px;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--box-shadow-light);
            min-width: 150px;
        }

        .reward-item .emoji {
            font-size: 3em;
        }

        .magic-quote {
            font-style: italic;
            font-family: 'Comic Neue', cursive;
            margin-top: 20px;
            color: var(--color-purple);
        }

        /* Footer */
        footer {
            margin-top: 40px;
            padding: 20px;
            background-color: var(--color-purple);
            color: var(--color-text-light);
            border-top-left-radius: var(--border-radius-large);
            border-top-right-radius: var(--border-radius-large);
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            box-shadow: none; /* Pas d'ombre sur le footer */
        }

        footer p {
            font-size: 0.9em;
            margin: 0;
            color: var(--color-text-light);
        }

        /* Media Queries pour la responsivité */
        @media (max-width: 768px) {
            h1 { font-size: 2.5em; }
            h2 { font-size: 1.8em; }
            h3 { font-size: 1.5em; }
            p { font-size: 1em; }
            .button { padding: 12px 25px; font-size: 1em; }
            .dragon-svg { width: 100px; height: 100px; }
            #catchphrase-container { font-size: 1.4em; }
            .nav-button { flex-direction: column; padding: 15px; font-size: 1em; }
            #tri-selectif-alimentaire .block { min-width: unset; }
            #progress-table thead th, #progress-table tbody td { padding: 10px; }
            #progress-table td button { font-size: 1.8em; }
            #missions-croquilou .mission-display { font-size: 1.2em; }
            .conseil-block h4 { font-size: 1.3em; }
            .food-grid { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        }

        @media (max-width: 480px) {
            header, section, footer { padding: 20px 10px; margin: 10px auto; }
            h1 { font-size: 2em; }
            h2 { font-size: 1.5em; }
            h3 { font-size: 1.3em; }
            .dragon-svg { width: 80px; height: 80px; }
            #catchphrase-container { font-size: 1.2em; }
            .nav-button { font-size: 0.9em; padding: 10px; }
            #progress-table td button { font-size: 1.5em; }
            .conseil-block h4 { font-size: 1.2em; }
            .food-grid { grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); }
        }

        /* Styles pour le message box personnalisé (remplace alert/confirm) */
        .custom-dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .custom-dialog-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .custom-dialog {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius-large);
            box-shadow: var(--box-shadow-light);
            text-align: center;
            max-width: 450px;
            width: 90%;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            position: relative;
        }

        .custom-dialog-overlay.visible .custom-dialog {
            transform: translateY(0);
            opacity: 1;
        }

        .custom-dialog h3 {
            margin-top: 0;
            color: var(--color-purple);
            font-size: 1.8em;
        }

        .custom-dialog p {
            margin-bottom: 25px;
            font-size: 1.1em;
            color: var(--color-text-dark);
        }

        .custom-dialog-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .custom-dialog-buttons button {
            background-color: var(--color-purple);
            color: white;
            padding: 12px 25px;
            border-radius: var(--border-radius-medium);
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            font-size: 1em;
            font-weight: bold;
        }

        .custom-dialog-buttons button:hover {
            background-color: #A569BD;
            transform: translateY(-2px);
        }

        .custom-dialog .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.8em;
            cursor: pointer;
            color: var(--color-purple);
            line-height: 1;
            padding: 0;
            transition: transform 0.2s ease;
        }

        .custom-dialog .close-button:hover {
            transform: rotate(90deg);
        }

        /* Styles for main content toggling */
        #jade-content, #morgane-content {
            display: none; /* Hidden by default, toggled by JS */
            flex-direction: column;
            gap: 20px; /* Space between sections */
        }
        #jade-content.active, #morgane-content.active {
            display: flex;
        }

    </style>
</head>
<body>

    <!-- Overlay pour les animations d'étoiles -->
    <div id="animationContainer" class="animation-container"></div>

    <!-- Boîte de dialogue personnalisée (remplace alert/confirm) -->
    <div id="customDialogOverlay" class="custom-dialog-overlay">
        <div class="custom-dialog">
            <button class="close-button" id="dialogCloseButton">✖</button>
            <h3 id="dialogTitle"></h3>
            <p id="dialogContent"></p>
            <div id="dialogButtons" class="custom-dialog-buttons">
                <!-- Les boutons seront ajoutés ici par JS -->
            </div>
        </div>
    </div>


    <header id="accueil">
        <!-- SVG du dragon Croquilou -->
        <svg class="dragon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2ZM8 10C8 8.89543 8.89543 8 10 8C11.1046 8 12 8.89543 12 10C12 11.1046 11.1046 12 10 12C8.89543 12 8 11.1046 8 10ZM14 10C14 8.89543 14.89543 8 16 8C17.1046 8 18 8.89543 18 10C18 11.1046 17.1046 12 16 12C14.89543 12 14 11.1046 14 10ZM12 14C9.33333 14 7 15 7 17C7 19 12 20 12 20C12 20 17 19 17 17C17 15 14.6667 14 12 14Z" fill="var(--color-purple)"/>
        </svg>
        <h1>Jade et le Royaume du Goûter</h1>
        <h2>Un monde enchanté pour apprivoiser les aliments</h2>
        <div id="catchphrase-container">
            <p id="catchphrase"></p>
        </div>
        <p>Bienvenue dans notre royaume spécial ! Ici, nous allons apprendre ensemble que chaque aliment est une nouvelle aventure et que ton ventre est un palais merveilleux où tout peut se transformer en force et en joie.</p>
        <p>Ce site est conçu pour deux explorateurs : **Jade**, pour un voyage magique à travers les saveurs, et **Morgane**, pour des conseils précieux et un accompagnement serein. Cliquez sur les boutons ci-dessous pour explorer le contenu qui vous est dédié !</p>
        <div class="navigation-buttons">
            <button id="showJadeContent" class="button nav-button">
                <span role="img" aria-label="enfant">🧒</span> Je suis Jade
            </button>
            <button id="showMorganeContent" class="button nav-button">
                <span role="img" aria-label="maman">👩‍👧</span> Je suis le parent de Jade
            </button>
        </div>
    </header>

    <main>
        <!-- Contenu dédié à Jade -->
        <div id="jade-content" class="active"> <!-- Active par défaut au chargement -->
            <section id="tri-selectif-alimentaire" class="jade-section-content">
                <h2>C'est quoi le tri sélectif alimentaire ?</h2>
                <div class="content-blocks">
                    <div class="block enfant">
                        <h3>Version enfant : Mon ami Croquilou et la peur du nouveau <button class="audio-button" data-audio-src="audios/intro_enfant.mp3"><span role="img" aria-label="haut-parleur">🔊</span></button></h3>
                        <p>Imagine que ton ventre est un royaume merveilleux et ton cerveau, le gardien de ce royaume. Parfois, ce gardien, qu'on appelle Croquilou 🐉, est un peu trop prudent. Il te fait croire que certains aliments sont des "intrus" alors qu'ils sont en fait des "amis" déguisés !</p>
                        <p>Croquilou est un petit dragon peureux, mais super mignon. Il a peur de tout ce qu'il ne connaît pas : une nouvelle couleur, une drôle de forme, une texture rigolote. C'est normal d'avoir un peu peur de l'inconnu ! Mais devine quoi ? C'est TOI qui peux lui montrer que le monde des goûters est plein de surprises délicieuses et amusantes !</p>
                        <p>Quand tu as une petite boule dans le ventre ou que tu fronces le nez devant un nouvel aliment, c'est Croquilou qui a peur. Il se dit : "Oh là là, c'est quoi ça ? Je ne connais pas !". Mais tu es la cheffe de ton royaume ! Tu peux lui apprendre à être courageux et à découvrir de nouvelles merveilles. 😖 ➝ 🐉 (avec l'aide de Jade) ➝ 🧘‍♀️ (Croquilou est apaisé !)</p>
                        <p>Chaque fois que tu explores un nouvel aliment, même juste en le regardant ou en le touchant, tu donnes une médaille de courage à Croquilou. Il apprend que le monde est plein de bonnes surprises !</p>
                    </div>
                </div>
            </section>

            <section id="super-pouvoirs-aliments" class="jade-section-content">
                <h2>Les Super-Pouvoirs des Aliments ✨</h2>
                <p>Sais-tu que chaque aliment a des pouvoirs magiques pour te rendre super forte et pleine d'énergie ? Clique sur chaque famille pour découvrir ses secrets et comment elle te transforme en super-héroïne !</p>
                <div class="food-grid">
                    <div class="food-item" data-food-type="fruits-legumes">
                        <span class="emoji">🍎🍓🍊</span>
                        <p>Les Fruits & Légumes : Tes Super-Boucliers !</p>
                    </div>
                    <div class="food-item" data-food-type="cereales-feculents">
                        <span class="emoji">🍞🍚🥔</span>
                        <p>Les Céréales & Féculents : Tes Carburants Turbo !</p>
                    </div>
                    <div class="food-item" data-food-type="laitiers-proteines">
                        <span class="emoji">🥛🧀🥚</span>
                        <p>Les Produits Laitiers & Protéines : Tes Briques de Construction !</p>
                    </div>
                    <div class="food-item" data-food-type="matieres-grasse">
                        <span class="emoji">🌰🥑🧈</span>
                        <p>Les Matières Grasses : Tes Énergies Douces !</p>
                    </div>
                    <div class="food-item" data-food-type="eau">
                        <span class="emoji">💧🥤</span>
                        <p>L'Eau : Ta Boisson Magique !</p>
                    </div>
                </div>
            </section>

            <section id="palette-sens" class="jade-section-content">
                <h2>La Palette des Saveurs et des Textures 🎨</h2>
                <p>Les aliments, ce n'est pas que le goût ! On peut les explorer avec tous nos sens, comme un artiste explore les couleurs ! Clique sur une saveur ou une texture pour découvrir une astuce de Croquilou !</p>
                <h3>Les Saveurs Mystérieuses</h3>
                <div class="food-grid">
                    <div class="food-item" data-flavor="acide">
                        <span class="emoji">🍋</span>
                        <p>Acide : Ça pique un peu la langue !</p>
                    </div>
                    <div class="food-item" data-flavor="sucre">
                        <span class="emoji">🍓</span>
                        <p>Sucré : Comme un câlin pour les papilles !</p>
                    </div>
                    <div class="food-item" data-flavor="sale">
                        <span class="emoji">🧂</span>
                        <p>Salé : Fait danser les petites gouttes de la bouche !</p>
                    </div>
                    <div class="food-item" data-flavor="amer">
                        <span class="emoji">🍫</span>
                        <p>Amer : Une saveur de grand, parfois surprenante !</p>
                    </div>
                    <div class="food-item" data-flavor="umami">
                        <span class="emoji">🥩</span>
                        <p>Umami : La saveur "Miam" qui fait revenir !</p>
                    </div>
                </div>
                <h3>Les Textures Amusantes</h3>
                <div class="food-grid">
                    <div class="food-item" data-texture="moelleux">
                        <span class="emoji">☁️</span>
                        <p>Moelleux (comme un nuage)</p>
                    </div>
                    <div class="food-item" data-texture="croquant">
                        <span class="emoji"> crunchy</span>
                        <p>Croquant (qui fait "crac" !) </p>
                    </div>
                    <div class="food-item" data-texture="collant">
                        <span class="emoji"> sticky</span>
                        <p>Collant (qui reste sur les doigts) </p>
                    </div>
                    <div class="food-item" data-texture="lisse">
                        <span class="emoji">smooth</span>
                        <p>Lisse (glisse dans la bouche) </p>
                    </div>
                    <div class="food-item" data-texture="gommeux">
                        <span class="emoji"> chewy</span>
                        <p>Gommeux (on mâche, on mâche...) </p>
                    </div>
                    <div class="food-item" data-texture="juteux">
                        <span class="emoji">💦</span>
                        <p>Juteux (plein de "jus" délicieux) </p>
                    </div>
                </div>
                <p>Explore ces sensations avec Croquilou, sans même manger ! Tu peux toucher, sentir, regarder... C'est déjà une grande aventure !</p>
            </section>


            <section id="tableau-magique-jade" class="jade-section-content">
                <h2>Le Tableau Magique de Jade</h2>
                <p>Clique sur les étoiles et les fruits chaque fois que tu réussis une mission ! Tu peux le faire !</p>
                <table id="progress-table">
                    <thead>
                        <tr>
                            <th>Mission</th>
                            <th>Lundi</th>
                            <th>Mardi</th>
                            <th>Mercredi</th>
                            <th>Jeudi</th>
                            <th>Vendredi</th>
                            <th>Samedi</th>
                            <th>Dimanche</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr data-row-key="goute-bouchee">
                            <td>J'ai goûté une bouchée 🍓</td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                            <td class="cell"><button data-emoji="🌟"></button></td>
                        </tr>
                        <tr data-row-key="pas-rale">
                            <td>Je n'ai pas râlé 🧚‍♀️</td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                            <td class="cell"><button data-emoji="✨"></button></td>
                        </tr>
                        <tr data-row-key="respire-non">
                            <td>J'ai respiré avant de dire non 🦄</td>
                            <td class="cell"><button data-emoji="💖"></button></td>
                            <td class="cell"><button data-emoji="💖"></button></td>
                            <td class="cell" ><button data-emoji="💖"></button></td>
                            <td class="cell" ><button data-emoji="💖"></button></td>
                            <td class="cell" ><button data-emoji="💖"></button></td>
                            <td class="cell" ><button data-emoji="💖"></button></td>
                            <td class="cell" ><button data-emoji="💖"></button></td>
                        </tr>
                    </tbody>
                </table>
                <button id="resetTableButton" class="button">Effacer ma semaine</button>
                <div id="progressIndicator" class="progress-indicator"></div>
            </section>

            <section id="missions-croquilou" class="jade-section-content">
                <h2>Missions de Croquilou</h2>
                <p>Croquilou te propose des missions rigolotes pour apprivoiser ta peur des aliments ! Chaque mission est un petit pas de géant pour devenir une super exploratrice des saveurs !</p>
                <div class="mission-display" id="currentMission">
                    Clique sur "Nouvelle Mission" pour commencer !
                </div>
                <button id="newMissionButton" class="button">Nouvelle Mission ✨</button>
                <button id="missionCompleteButton" class="button" style="display:none;">Mission Accomplie ! 🏆</button>
                <h3>Mes Badges de Super Héros</h3>
                <div class="gallery" id="badgesGallery">
                    <!-- Les badges seront ajoutés ici par JS -->
                </div>
            </section>

            <section id="zone-recompense" class="jade-section-content">
                <h2>Zone de Récompense de Jade</h2>
                <p>Regarde toutes les étoiles que tu as gagnées ! Chaque pas est une victoire, chaque défi relevé te rend plus forte et plus courageuse !</p>
                <div class="gallery" id="rewardGallery">
                    <!-- Les récompenses seront ajoutées ici par JS -->
                </div>
                <p class="magic-quote" id="rewardQuote"></p>
                <button id="printWeekButton" class="button">Imprimer ma semaine ! 🖨️</button>
            </section>
        </div>

        <!-- Contenu dédié à Morgane (caché par défaut) -->
        <div id="morgane-content">
            <section id="conseils-maman">
                <h2>💬 Conseils pour une maman courage</h2>
                <p class="intro-text">
                    Morgane, je sais à quel point c’est difficile. Quand chaque repas devient un casse-tête, quand Jade change d’avis, refuse, exige… tu as l’impression de marcher sur des œufs. Mais tu fais déjà beaucoup. Et tu peux reprendre la main sans te battre. Rappelle-toi que tu n'es pas seule et que chaque petit pas compte. La bienveillance et la constance sont tes meilleures alliées.
                </p>
                <p>
                    <strong>Explication simplifiée de l’ARFID :</strong> Ce n'est pas un caprice, mais une peur déguisée. Cependant, cette peur peut être exploitée (sans le vouloir) par l’enfant pour éviter, contrôler ou tester les limites. Votre rôle est de rassurer tout en posant un cadre bienveillant et ferme.
                </p>

                <div class="conseil-block">
                    <h4>Les Piliers du Cadre Bienveillant à Table</h4>
                    <div class="action-plan">
                        <ul>
                            <li><strong>Limiter les choix : Une alternative, et c'est tout.</strong> Proposez le plat familial principal. Si l'enfant refuse, une seule alternative "sécurisante" est offerte. Évitez les "menus à la carte" qui peuvent renforcer l'évitement et donner trop de pouvoir à l'enfant sur le contenu du repas.
                                <br><em>Exemple : "Voici le dîner. Si tu n'as pas faim pour ça, tu peux prendre un peu de riz."</em></li>
                            <li><strong>Fixer des règles temporelles : Un début, une fin.</strong> Le repas dure un temps défini (ex : 20-30 minutes pour les jeunes enfants). Après ce délai, le repas est terminé, qu'il ait mangé ou non. On ne remplace pas ce repas par un autre, et on n'ajoute pas de "dessert de consolation" juste après. L'enfant apprend qu'il y a des opportunités de manger.</li>
                            <li><strong>Établir un "menu de sécurité" : Toujours une base rassurante.</strong> Ayez toujours à disposition un ou deux aliments "sécurisants" pour l'enfant (ex : riz nature, un morceau de pain, une compote de fruits sans morceaux). Cela réduit l'anxiété de l'enfant et lui assure qu'il y aura toujours quelque chose qu'il peut manger, sans que vous n'ayez à céder sur le plat principal.</li>
                            <li><strong>Refuser de négocier dans l'instant : Différer la discussion.</strong> Si une négociation s'engage pendant le repas, reportez la discussion à un moment calme plus tard (rituel du soir, petit carnet où Jade peut noter ses pensées ou ses peurs). Le repas n'est pas le lieu de la confrontation.</li>
                            <li><strong>Ne pas insister, ne pas punir, ne pas surprotéger : Dédramatiser.</strong> Créez un environnement serein autour du repas. Ne forcez jamais l'enfant à manger, ne le punissez pas pour ses refus, et n'éliminez pas tous les aliments "difficiles" de la table familiale. L'exposition, même visuelle ou olfactive, est importante. L'objectif est de dédramatiser l'acte de manger.</li>
                        </ul>
                    </div>
                </div>

                <div class="conseil-block">
                    <h4>Comprendre les Comportements de l'Enfant : Peur vs. "Surjeu"</h4>
                    <p>Il est parfois difficile de distinguer une réelle aversion liée à l'ARFID d'un comportement appris ou d'une tentative de tester les limites. Voici quelques pistes :</p>
                    <ul>
                        <li><strong>La peur est authentique :</strong> Un enfant avec ARFID a une réaction sensorielle ou émotionnelle très forte et involontaire. La peur est réelle et n'est pas un choix. Les réactions peuvent sembler exagérées pour un observateur extérieur, mais elles sont vécues intensément par l'enfant.</li>
                        <li><strong>Le "surjeu" ou le test des limites :</strong> Certains enfants peuvent, consciemment ou non, "surjouer" leur réaction pour éviter un aliment ou pour voir jusqu'où ils peuvent aller. C'est souvent une stratégie apprise pour obtenir un "menu de substitution" facile ou pour attirer l'attention.
                            <br><em>Comment faire la différence ?</em> Observez la constance des réactions. Un enfant qui surjoue peut "oublier" sa peur pour un aliment donné dans un autre contexte (ex: chez un ami, à la crèche, ou si l'aliment est présenté différemment avec d'autres personnes). Une vraie aversion ARFID est plus constante et intense, quelles que soient les circonstances. La fatigue, le stress ou les changements de routine peuvent aussi amplifier les réactions.</li>
                        <li><strong>L'importance du cadre :</strong> C'est pourquoi le cadre bienveillant mais ferme est essentiel. Il rassure l'enfant sur la prévisibilité du repas tout en lui montrant que vous êtes le parent, et que certaines règles ne sont pas négociables. Si l'enfant essaie de tester, votre neutralité et la constance du cadre sont vos meilleures réponses. Évitez les négociations qui renforcent le comportement d'évitement.</li>
                    </ul>
                </div>

                <div class="conseil-block">
                    <h4>Éduquer à la Nutrition : Pourquoi Manger Varié ?</h4>
                    <p>Expliquez à Jade, avec des mots simples et imagés, l'importance de chaque famille d'aliments. Pas de leçon magistrale, mais des petites anecdotes, des comparaisons amusantes. L'objectif est de semer des graines de curiosité et de compréhension, pas d'imposer des règles rigides.</p>
                    <ul>
                        <li><strong>Les "héros" de l'assiette :</strong> Chaque couleur de légume a un super-pouvoir différent ! Le rouge pour l'énergie (tomate), le vert pour la protection (brocoli), l'orange pour la bonne vue (carotte).</li>
                        <li><strong>L'énergie pour jouer et apprendre :</strong> Les pâtes, le pain et le riz sont comme le "carburant" pour courir, sauter et bien réfléchir à l'école. Ils te donnent la force de faire toutes tes activités préférées.</li>
                        <li><strong>Les bâtisseurs du corps :</strong> Le lait, le fromage, les œufs et la viande construisent tes muscles et tes os pour que tu grandisses bien. Ce sont les "briques" de ton corps de super-héros !</li>
                        <li><strong>L'eau, la boisson magique :</strong> Essentielle pour que tout ton corps fonctionne bien, pour rester bien hydratée et pleine de vie. C'est le secret pour te sentir légère et joyeuse !</li>
                    </ul>
                    <p>Utilisez les mêmes métaphores que dans la section enfant pour créer de la cohérence et renforcer le message.</p>
                </div>

                <div class="conseil-block">
                    <h4>Stratégies d'Introduction Alimentaire en Douceur</h4>
                    <ul>
                        <li><strong>L'exposition répétée : La clé de l'acceptation.</strong> Il faut en moyenne 10 à 15 expositions à un nouvel aliment avant qu'un enfant ne l'accepte, parfois beaucoup plus pour les enfants avec ARFID. Présentez le même aliment régulièrement, sans pression. L'objectif est de le rendre familier et de réduire la néophobie.</li>
                        <li><strong>Les "ponts alimentaires" (Food Chaining) : Construire sur l'existant.</strong> Identifiez les aliments que votre enfant accepte et essayez d'introduire des aliments qui y ressemblent en texture, couleur ou goût.
                            <br><em>Exemple : S'il mange des frites, proposez des bâtonnets de carotte cuite au four. S'il mange du pain blanc, introduisez un pain de mie légèrement plus complet ou une petite croûte de pain de campagne. S'il mange du yaourt lisse, tentez une compote sans morceaux, puis une compote avec de très petits morceaux.</em></li>
                        <li><strong>Les "mini-bouchées" et les "goûts de fées" : Une pression minimale.</strong> Ne demandez pas une "assiette propre". L'objectif est de réduire la peur. Demandez juste de toucher l'aliment, de le sentir, de le lécher ou de prendre une minuscule "bouchée de fée" (la taille d'un grain de riz). Célébrez ce petit pas comme une grande victoire.</li>
                        <li><strong>La déconstruction des aliments : Explorer les composants.</strong> Plutôt que de servir un plat complexe, présentez les ingrédients séparément (ex : les pâtes, la sauce tomate à part, le fromage râpé à côté). L'enfant peut choisir ce qu'il est prêt à manger, ce qui lui donne un sentiment de contrôle.</li>
                        <li><strong>Impliquer l'enfant dans la préparation : Rendre l'aliment familier.</strong> Permettez à Jade de laver les légumes, de mélanger les ingrédients, de mettre la table. Plus elle interagit avec les aliments dans un contexte non-stressant, plus ils deviennent familiers et moins menaçants. C'est l'occasion d'éduquer par le jeu et l'expérience directe.</li>
                        <li><strong>Le jeu sensoriel avec les aliments :</strong> Proposez des activités non-alimentaires avec de la nourriture. Peindre avec de la purée, créer des formes avec des pâtes cuites, explorer les graines d'un melon. Cela réduit l'aversion sensorielle et rend la nourriture moins intimidante en dehors du contexte du repas.</li>
                    </ul>
                </div>

                <div class="conseil-block">
                    <h4>Gérer les Émotions à Table (Pour Jade et Pour Vous)</h4>
                    <ul>
                        <li><strong>Valider les émotions de Jade :</strong> Reconnaissez sa peur ou son dégoût sans les juger. "Je vois que tu n'aimes pas la texture de ça, c'est ok." Cela lui montre que vous la comprenez, même si vous maintenez le cadre. Évitez les phrases comme "C'est délicieux, tu devrais aimer !", car cela peut invalider son ressenti.</li>
                        <li><strong>Restez calme et neutre :</strong> Votre réaction est très importante. La colère, la frustration ou la sur-insistance augmentent l'anxiété de l'enfant et renforcent les comportements d'évitement. Respirez profondément. Un repas calme, même si peu est mangé, est une victoire en soi pour l'ambiance familiale.</li>
                        <li><strong>Célébrez les petites victoires :</strong> Chaque petit pas compte ! Même le fait de toucher un aliment, de le sentir, ou de le regarder sans réagir négativement est une victoire. Mettez l'accent sur ces réussites, pas sur ce qui n'a pas été mangé.</li>
                        <li><strong>Rituel de fin de repas :</strong> Si le repas a été difficile, terminez par un moment positif : une histoire, un câlin. Évitez de prolonger la tension. Le repas doit rester un moment familial, pas un champ de bataille.</li>
                    </ul>
                </div>

                <div class="conseil-block">
                    <h4>Quand et Qui Consulter : Le Rôle des Professionnels</h4>
                    <p>Si les difficultés persistent, impactent la croissance de Jade, ou si vous vous sentez démunie, n'hésitez pas à demander de l'aide.</p>
                    <ul>
                        <li><strong>Pédiatre :</strong> Pour un suivi de la croissance et une première évaluation.</li>
                        <li><strong>Nutritionniste / Diététicien.ne spécialisé.e :</strong> Pour évaluer les apports nutritionnels et élaborer des stratégies alimentaires adaptées.</li>
                        <li><strong>Psychologue pour enfants :</strong> Si l'anxiété est très présente, si des phobies spécifiques sont identifiées, ou pour travailler sur les comportements. Les TCC (Thérapies Comportementales et Cognitives) sont souvent efficaces.</li>
                        <li><strong>Ergothérapeute / Thérapeute en intégration sensorielle :</strong> Si des problèmes d'hypersensibilité sensorielle sont la cause principale des refus alimentaires.</li>
                        <li><strong>Orthophoniste :</strong> Pour les troubles de l'oralité (difficultés à mâcher, déglutir).</li>
                    </ul>
                </div>

                <div class="conseil-block">
                    <h4>Prendre Soin de Soi : Le Bien-être de la Maman</h4>
                    <p>N'oubliez pas que vous êtes humaine et que cette situation est épuisante. Vous êtes une maman formidable ! Votre bien-être est essentiel pour pouvoir soutenir Jade sur le long terme.</p>
                    <ul>
                        <li><strong>Parlez-en :</strong> Ne restez pas seule avec vos préoccupations. Partagez vos difficultés avec un.e ami.e, votre partenaire, un membre de votre famille ou un groupe de soutien. Parfois, le simple fait de verbaliser aide énormément.</li>
                        <li><strong>Fixez des limites réalistes :</strong> Acceptez que les progrès soient lents et qu'il y aura des jours "avec" et des jours "sans". Ne visez pas la perfection, mais la progression constante, même minime. Chaque effort de Jade est un succès.</li>
                        <li><strong>Déléguez ou demandez de l'aide :</strong> Si possible, alternez les repas difficiles avec votre partenaire ou un autre adulte de confiance. N'hésitez pas à solliciter l'aide de professionnels si vous vous sentez dépassée (nutritionniste, psychologue spécialisé en troubles alimentaires de l'enfant).</li>
                        <li><strong>Accordez-vous des moments de répit :</strong> Prenez du temps pour vous, même quelques minutes par jour, pour vous ressourcer et recharger vos batteries. Un esprit reposé est plus patient et plus créatif.</li>
                        <li><strong>Ressources Utiles (lectures, associations) :</strong>
                            <ul>
                                <li>Livre : "Mon enfant ne mange pas" par Dr. Nicole Delannoy</li>
                                <li>Association : Enfant et Alimentation (ex: AFPRAL pour les allergies si concerné, ou groupes de soutien spécifiques ARFID)</li>
                                <li>Sites web spécialisés dans l'alimentation pédiatrique et les troubles alimentaires.</li>
                            </ul>
                            <p>Ces ressources peuvent vous apporter des informations complémentaires et un soutien précieux.</p>
                        </li>
                    </ul>
                </div>

                <p class="citation">
                    “Être parent, ce n’est pas être parfait. C’est être présent, lucide, et apprendre à poser des cadres avec douceur.”
                </p>
                <button id="downloadPdfButton" class="button">Télécharger le "Mini Guide Parent de Jade" 📄</button>
                <p><em>(Astuce : pour télécharger, utilisez la fonction d'impression de votre navigateur et choisissez "Enregistrer en PDF")</em></p>
            </section>
        </div>
    </main>

    <footer>
        <p>© 2025 Jade et le Royaume du Goûter. Conçu avec magie et bienveillance.</p>
    </footer>

    <script>
        // JavaScript pour les fonctionnalités du site

        // --- Utilitaires : Boîte de dialogue personnalisée (remplace alert/confirm) ---
        const customDialogOverlay = document.getElementById('customDialogOverlay');
        const dialogTitle = document.getElementById('dialogTitle');
        const dialogContent = document.getElementById('dialogContent');
        const dialogButtonsContainer = document.getElementById('dialogButtons');
        const dialogCloseButton = document.getElementById('dialogCloseButton');

        /**
         * Affiche une boîte de dialogue personnalisée.
         * @param {string} title - Le titre de la boîte de dialogue.
         * @param {string} message - Le message à afficher.
         * @param {string} type - Le type de dialogue ('alert' ou 'confirm').
         * @param {function} [callback] - Fonction à exécuter si 'confirm' est cliqué (pour type 'confirm').
         */
        function showCustomDialog(title, message, type = 'alert', callback = null) {
            dialogTitle.textContent = title;
            dialogContent.textContent = message;
            dialogButtonsContainer.innerHTML = ''; // Nettoyer les boutons précédents

            // Bouton de fermeture en haut à droite
            dialogCloseButton.onclick = () => {
                customDialogOverlay.classList.remove('visible');
            };

            if (type === 'alert') {
                const okButton = document.createElement('button');
                okButton.textContent = 'OK';
                okButton.onclick = () => customDialogOverlay.classList.remove('visible');
                dialogButtonsContainer.appendChild(okButton);
            } else if (type === 'confirm') {
                const confirmButton = document.createElement('button');
                confirmButton.textContent = 'Oui';
                confirmButton.onclick = () => {
                    customDialogOverlay.classList.remove('visible');
                    if (callback) callback(true);
                };
                dialogButtonsContainer.appendChild(confirmButton);

                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Non';
                cancelButton.onclick = () => {
                    customDialogOverlay.classList.remove('visible');
                    if (callback) callback(false);
                };
                dialogButtonsContainer.appendChild(cancelButton);
            }

            customDialogOverlay.classList.add('visible');

            // Fermer le dialogue en cliquant en dehors de la boîte
            customDialogOverlay.onclick = (event) => {
                if (event.target === customDialogOverlay) {
                    customDialogOverlay.classList.remove('visible');
                }
            };
        }


        // --- Page d'accueil : Animation du texte ---
        const catchphraseElement = document.getElementById('catchphrase');
        // Corrected spacing in the phrase
        const catchphraseText = "Bonjour Jade, prête à relever un nouveau défi aujourd'hui ?";

        function animateCatchphrase() {
            catchphraseElement.innerHTML = ''; // Réinitialise le contenu
            catchphraseText.split('').forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char;
                span.style.setProperty('--delay', `${index * 0.05}s`); // Délai pour chaque caractère
                catchphraseElement.appendChild(span);
            });
        }

        // --- Navigation : Afficher/Cacher les sections Jade/Morgane ---
        const showJadeContentButton = document.getElementById('showJadeContent');
        const showMorganeContentButton = document.getElementById('showMorganeContent');
        const jadeContent = document.getElementById('jade-content');
        const morganeContent = document.getElementById('morgane-content');

        // Function to hide all main content sections
        function hideAllContentSections() {
            jadeContent.classList.remove('active');
            morganeContent.classList.remove('active');
        }

        // Event listener for "Je suis Jade" button
        showJadeContentButton.addEventListener('click', () => {
            hideAllContentSections();
            jadeContent.classList.add('active');
            jadeContent.scrollIntoView({ behavior: 'smooth' }); // Scroll to the Jade content
        });

        // Event listener for "Je suis le parent de Jade" button
        showMorganeContentButton.addEventListener('click', () => {
            hideAllContentSections();
            morganeContent.classList.add('active');
            morganeContent.scrollIntoView({ behavior: 'smooth' }); // Scroll to the Morgane content
        });


        // --- Tri Sélectif : Bouton Audio (fichier local) ---
        const audioPlayer = new Audio(); // Crée un élément audio une seule fois
        const audioButtons = document.querySelectorAll('.audio-button');

        audioButtons.forEach(button => {
            button.addEventListener('click', () => {
                const audioSrc = button.dataset.audioSrc;
                if (audioSrc) {
                    audioPlayer.src = audioSrc;
                    audioPlayer.play().catch(e => console.error("Erreur de lecture audio :", e));
                } else {
                    console.warn("Aucun fichier audio spécifié pour ce bouton.");
                    showCustomDialog("Erreur audio", "Le fichier audio n'a pas pu être chargé. Veuillez vérifier le chemin d'accès ('audios/intro_enfant.mp3' par exemple).", 'alert');
                }
            });
        });

        // --- Super-Pouvoirs et Palette des Sens : Interactions ---
        const foodDescriptions = {
            'fruits-legumes': {
                title: "Les Fruits & Légumes : Tes Super-Boucliers !",
                content: "Ils sont pleins de vitamines et te donnent de l'énergie pour courir, sauter et jouer toute la journée ! C'est comme un bouclier magique qui protège ton corps des petits bobos et te rend super résistante. Pense aux épinards qui donnent de la force comme Popeye, ou aux carottes qui rendent tes yeux vifs comme un aigle ! Mange-en de toutes les couleurs pour avoir tous les super-pouvoirs !"
            },
            'cereales-feculents': {
                title: "Les Céréales & Féculents : Tes Carburants Turbo !",
                content: "Le pain, les pâtes, le riz, les pommes de terre... Ce sont les super-carburants de ton corps ! Ils te donnent l'énergie stable pour bien réfléchir à l'école, apprendre de nouvelles choses et avoir la pêche pour tes missions Croquilou. C'est comme le carburant d'une voiture de course : sans lui, elle n'avance pas ! Choisis-les complets quand tu peux, ils te donnent encore plus d'énergie !"
            },
            'laitiers-proteines': {
                title: "Les Produits Laitiers & Protéines : Tes Briques de Construction !",
                content: "Le lait, le fromage, les œufs, le poisson, la viande... Ce sont les bâtisseurs de ton corps ! Ils aident tes os à grandir bien droits et forts, tes muscles à devenir puissants pour grimper partout, et tes cheveux à briller. C'est comme construire une super maison solide pour ton corps, avec des briques magiques !"
            },
            'matieres-grasse': {
                title: "Les Matières Grasses : Tes Énergies Douces !",
                content: "L'huile, le beurre, les avocats, les noix... En petite quantité, ces aliments sont de l'énergie concentrée ! Ils aident ton cerveau à bien fonctionner (pour être super intelligente !), et à garder ta peau douce. C'est une énergie douce qui te suit longtemps, comme une petite batterie secrète !"
            },
            'eau': {
                title: "L'Eau : Ta Boisson Magique !",
                content: "L'eau, c'est la boisson la plus importante de toutes ! Elle aide ton corps à bien fonctionner, à rester hydratée (surtout quand tu as chaud ou que tu joues beaucoup), et à faire voyager tous les super-pouvoirs des aliments partout dans ton corps. Bois de l'eau souvent pour être toujours au top de ta forme, comme un arbre qui boit bien pour être grand et fort !"
            },
            'acide': {
                title: "La Saveur Acide : Ça Pique un peu !",
                content: "L'acide, c'est comme le goût du citron 🍋, du vinaigre ou de certains bonbons qui piquent la langue ! C'est une saveur surprenante, qui te réveille les papilles. Si tu goûtes un aliment acide, tu peux faire une petite grimace rigolote, c'est normal ! Essaie de le mélanger avec une saveur sucrée, comme une limonade, c'est plus doux !"
            },
            'sucre': {
                title: "La Saveur Sucrée : Un Câlin pour les Papilles !",
                content: "Le sucré, c'est le goût des fruits mûrs 🍓, du miel, des gâteaux. C'est une saveur que l'on aime souvent beaucoup ! Elle te donne de l'énergie rapidement, comme un petit coup de pouce pour jouer. Mais attention, trop de sucré peut fatiguer Croquilou, alors il faut en manger avec modération pour que ton ventre reste joyeux !"
            },
            'sale': {
                title: "La Saveur Salée : Fait Danser les Petites Gouttes !",
                content: "Le salé, c'est le goût des chips 🧂, du fromage, du pain. C'est une saveur qui fait saliver la bouche et qui donne envie de revenir ! Il y a du sel dans beaucoup d'aliments, mais il faut en manger juste ce qu'il faut pour que Croquilou soit content. Une petite pincée, c'est bien, une grosse pincée, c'est trop !"
            },
            'amer': {
                title: "La Saveur Amère : La Surprise du Grand !",
                content: "L'amer, c'est une saveur un peu spéciale, comme le chocolat très noir 🍫, le café ou certaines salades vertes. C'est une saveur que les grands apprennent souvent à aimer. Si tu goûtes quelque chose d'amer et que tu n'aimes pas, c'est ok ! Croquilou apprendra petit à petit. Tu peux essayer d'y goûter une toute petite goutte, c'est déjà une grande victoire !"
            },
            'umami': {
                title: "La Saveur Umami : Le Goût 'Miam' !",
                content: "L'umami, c'est une saveur un peu mystérieuse, difficile à décrire, mais c'est celle qui te fait dire 'Miam !' 🥩. On la trouve dans le fromage, les champignons, la viande, la sauce tomate. C'est une saveur ronde et savoureuse qui donne envie de revenir. C'est comme un secret délicieux que Croquilou découvre avec toi !"
            },
            'moelleux': {
                title: "La Texture Moelleuse : Douce comme un Nuage !",
                content: "Un gâteau ☁️, un marshmallow, une banane bien mûre... C'est doux en bouche, facile à mâcher. C'est comme une texture doudou pour ta langue ! Croquilou aime bien le moelleux, c'est rassurant. Essaie de le sentir, de l'écraser un peu entre tes doigts, c'est amusant !"
            },
            'croquant': {
                title: "La Texture Croquante : Ça Fait 'Crac' !",
                content: "Une carotte 🥕, une pomme 🍎, un biscuit sec... Quand tu croques, ça fait un petit bruit amusant ! Le croquant, c'est super pour tes dents, ça les rend fortes. Si Croquilou a peur du bruit, tu peux croquer doucement d'abord, ou juste écouter le 'crac' des autres !"
            },
            'collant': {
                title: "La Texture Collante : Reste sur les Doigts !",
                content: "Le riz qui colle 🍚, le miel 🍯, certains bonbons... C'est une texture qui peut être surprenante ! Elle peut rester un peu sur la langue ou les doigts. Croquilou peut trouver ça rigolo ou un peu bizarre. Tu peux la toucher du bout du doigt pour voir comment ça colle, c'est une mission courageuse !"
            },
            'lisse': {
                title: "La Texture Lisse : Ça Glisse dans la Bouche !",
                content: "Une purée bien lisse, un yaourt 🥛, une soupe veloutée... Ça glisse tout seul dans la bouche, sans morceaux. C'est souvent une texture très agréable pour Croquilou, car il n'y a pas de surprise. Essaie de la faire glisser sur ta langue, comme sur un toboggan !"
            },
            'gommeux': {
                title: "La Texture Gommeuse : On Mâche, on Mâche !",
                content: "Certains fromages, des bonbons un peu mous, des pâtes un peu trop cuites... C'est une texture qui demande de bien mâcher. Ça peut être un peu fatigant pour les mâchoires de Croquilou ! Mais c'est une bonne mission pour apprendre à bien mastiquer et rendre ton ventre content."
            },
            'juteux': {
                title: "La Texture Juteuse : Plein de 'Jus' Délicieux !",
                content: "Une orange 🍊, une pastèque 🍉, des tomates bien mûres... Quand tu croques, il y a plein de jus qui coule ! C'est super rafraîchissant et rempli de saveurs. Croquilou aime le juteux car c'est une surprise pleine de saveur et de fraîcheur !"
            }
        };

        document.querySelectorAll('.food-item[data-food-type], .food-item[data-flavor], .food-item[data-texture]').forEach(item => {
            item.addEventListener('click', function() {
                const type = this.dataset.foodType || this.dataset.flavor || this.dataset.texture;
                if (foodDescriptions[type]) {
                    showCustomDialog(foodDescriptions[type].title, foodDescriptions[type].content, 'alert');
                }
            });
        });


        // --- Tableau Magique de Jade ---
        const progressTable = document.getElementById('progress-table');
        const resetButton = document.getElementById('resetTableButton');
        const progressIndicator = document.getElementById('progressIndicator');
        const animationContainer = document.getElementById('animationContainer');

        // Initialiser le tableau avec les données de localStorage
        function loadProgress() {
            const savedProgress = JSON.parse(localStorage.getItem('jadeProgress')) || {};
            const cells = progressTable.querySelectorAll('.cell button');
            cells.forEach(button => {
                const rowKey = button.closest('tr').dataset.rowKey;
                // Obtenir l'index de la colonne pour le jour
                const cellIndex = Array.from(button.parentNode.parentNode.children).indexOf(button.parentNode) - 1;
                const dayIndex = cellIndex;

                if (savedProgress[rowKey] && savedProgress[rowKey][dayIndex]) {
                    button.innerHTML = savedProgress[rowKey][dayIndex]; // Affiche l'emoji sauvegardé
                    button.classList.add('active');
                } else {
                    // Réinitialiser au texte par défaut si pas de sauvegarde ou si la case est vide
                    const defaultEmoji = button.dataset.emoji;
                    button.innerHTML = defaultEmoji;
                    button.classList.remove('active');
                }
            });
            updateWeeklyProgress();
        }

        // Sauvegarder la progression dans localStorage
        function saveProgress() {
            const currentProgress = {};
            progressTable.querySelectorAll('tbody tr').forEach(row => {
                const rowKey = row.dataset.rowKey;
                currentProgress[rowKey] = [];
                row.querySelectorAll('.cell button').forEach( (button, index) => {
                    // Sauvegarde l'innerHTML du bouton si actif, sinon null
                    currentProgress[rowKey][index] = button.classList.contains('active') ? button.innerHTML : null;
                });
            });
            localStorage.setItem('jadeProgress', JSON.stringify(currentProgress));
        }

        // Gérer les clics sur les cellules du tableau
        progressTable.addEventListener('click', (event) => {
            const target = event.target;
            if (target.tagName === 'BUTTON' && target.closest('.cell')) {
                const defaultEmoji = target.dataset.emoji;
                if (target.classList.contains('active')) {
                    target.classList.remove('active');
                    target.innerHTML = defaultEmoji; // Remet l'emoji par défaut
                } else {
                    target.classList.add('active');
                    target.innerHTML = defaultEmoji; // Ajoute l'emoji actif (peut être le même, mais la classe change le style)
                }
                saveProgress();
                updateWeeklyProgress();
            }
        });

        // Réinitialiser le tableau avec custom dialog
        resetButton.addEventListener('click', () => {
            showCustomDialog(
                "Effacer la semaine ?",
                "Es-tu sûr(e) de vouloir effacer toute ta progression de la semaine ? Cette action est irréversible !",
                "confirm",
                (confirmed) => {
                    if (confirmed) {
                        localStorage.removeItem('jadeProgress');
                        loadProgress(); // Recharge le tableau vide
                        showCustomDialog("Semaine effacée !", "Toute ta progression pour cette semaine a été effacée. Prête pour une nouvelle semaine de défis ?", 'alert');
                    } else {
                        showCustomDialog("Annulé !", "Ta semaine est toujours là ! Continue tes progrès !", 'alert');
                    }
                }
            );
        });

        // Mettre à jour l'indicateur de progression hebdomadaire et déclencher l'animation
        function updateWeeklyProgress() {
            let totalStars = 0;
            progressTable.querySelectorAll('tbody tr').forEach(row => {
                row.querySelectorAll('.cell button.active').forEach(() => {
                    totalStars++;
                });
            });

            progressIndicator.textContent = `Tu as accumulé ${totalStars} étoiles cette semaine !`;

            // Déclenche l'animation pour différents paliers de progression
            if (totalStars > 0 && totalStars % 5 === 0) { // Toutes les 5 étoiles
                triggerConfettiAnimation("Bravo Jade !");
            }
            updateRewardGallery(); // Mettre à jour la galerie de récompenses
        }

        // Fonction pour l'animation de chute d'étoiles
        function triggerConfettiAnimation(title) {
            animationContainer.style.display = 'block';
            showCustomDialog(title, "Tu es incroyable ! Regarde les étoiles tomber pour toi !", 'alert');

            const numStars = 30; // Nombre d'étoiles
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.textContent = '🌟'; // Emoji étoile
                // Positionnement aléatoire initial
                star.style.left = `${Math.random() * 100}vw`;
                star.style.top = `${Math.random() * -20}vh`; // Commence au-dessus de l'écran

                // Destination aléatoire
                star.style.setProperty('--end-x', `${Math.random() * 200 - 50}px`); // De -50 à 150px
                star.style.setProperty('--end-y', `${window.innerHeight + 100}px`);

                animationContainer.appendChild(star);

                // Supprimer l'étoile après l'animation
                star.addEventListener('animationend', () => {
                    star.remove();
                    // Cacher le conteneur d'animation une fois toutes les étoiles parties
                    if (animationContainer.childElementCount === 0) {
                        animationContainer.style.display = 'none';
                    }
                });
            }
        }


        // --- Missions de Croquilou ---
        const missions = [
            "Regarde un aliment inconnu sans froncer les sourcils 😉",
            "Décris une odeur avec un mot rigolo (ex: 'odeur de soleil', 'odeur de doudou') 👃",
            "Mets un aliment 'bizarre' dans ton assiette même sans le manger (juste pour le regarder !) 👀",
            "Touche un aliment qui colle sans faire 'Beurk' (ex: purée, confiture) 🖐️",
            "Fais un dessin de ton aliment préféré et de l'aliment que tu veux apprivoiser 🎨",
            "Donne un nom rigolo à un nouveau légume 🥦 (Ex: 'Brocoli-fusée', 'Carotte-magicienne')",
            "Écoute le bruit d'un aliment quand tu le croques (ex: carotte, pomme) 👂",
            "Aide à préparer le repas en touchant un ingrédient que tu ne manges pas d'habitude 🧑‍🍳",
            "Choisis une couleur et trouve un aliment de cette couleur à regarder �",
            "Imagine une histoire avec un légume qui parle 📚",
            "Dis 'Bonjour' à un aliment que tu n'aimes pas d'habitude 👋",
            "Dessine le visage de Croquilou quand il a peur d'un aliment 😱",
            "Range les aliments par couleur ou par taille dans le frigo (avec l'aide d'un adulte) 🌈",
            "Goûte un minuscule morceau d'un aliment nouveau avec un aliment que tu aimes beaucoup (ex: une miette de brocoli avec ton riz préféré) 🍚🥦",
            "Décris la texture d'un fruit ou d'un légume (ex: 'glissant', 'granuleux', 'doux') en le touchant 🌱",
            "Fais la course avec un aliment (ex: fais rouler une pomme) 🍎",
            "Compte combien il y a de grains de maïs sur une seule ligne d'un épi 🌽",
            "Regarde un légume couper en deux et observe ses 'dessins' intérieurs 🧅",
            "Crée une petite chanson sur un aliment que tu aimes ❤️🎵",
            "Choisis un aliment et imagine-le en train de faire du sport 💪",
            "Ferme les yeux et essaie de deviner quel est l'aliment qu'on te fait sentir 👃🤫",
            "Prépare ton propre 'plateau de l'exploratrice' avec un mini bout de 3 aliments différents (dont un nouveau) 🍽️",
            "Fais une grimace marrante en pensant à un aliment que tu n'aimes pas, puis un sourire en pensant à un que tu aimes ! 😁😖",
            "Donne un câlin à Croquilou (ton ventre) et dis-lui que tu es courageuse ! 🤗",
            "Regarde un livre avec des images d'aliments et nomme ceux que tu connais 📖",
            "Trie tes céréales du petit déjeuner par forme ou couleur 🥣",
            "Essaie de faire flotter une cerise dans l'eau et observe ce qui se passe 🍒💧",
            "Donne un nom de super-héros à ton légume préféré (ex: 'Captain Carotte') 🦸‍♀️🥕",
            "Fais une tour avec des biscuits secs (sans les casser !) 🗼🍪",
            "Explore l'intérieur d'une gousse de petit pois et compte les petits pois à l'intérieur 🫛",
            "Décris le son que fait un aliment quand on le secoue (ex: des pâtes crues, des lentilles) 🔊🍝",
            "Crée une petite histoire avec des aliments qui voyagent dans l'espace 🚀🌌",
            "Trouve un aliment qui a la même forme qu'un de tes jouets préférés 🧸",
            "Compare deux fruits de la même couleur mais de tailles différentes (ex: une petite pomme et une grosse pomme) 🍏🍎",
            "Fais un parcours d'obstacles pour un mini-légume sur la table de la cuisine 🏃‍♀️💨",
            "Utilise des fruits pour faire des empreintes sur du papier (avec un peu de peinture lavable !) 🎨🍇",
            "Observe comment l'eau change la couleur d'un aliment (ex: un morceau de pain) 🍞💦",
            "Fais semblant d'être un détective et cherche les 'indices' sur un aliment (taches, formes, etc.) 🕵️‍♀️",
            "Imagine que tu es un chef cuisinier et décris un plat que tu vas inventer avec un nouvel aliment 🧑‍🍳✨"
        ];

        const currentMissionDisplay = document.getElementById('currentMission');
        const newMissionButton = document.getElementById('newMissionButton');
        const missionCompleteButton = document.getElementById('missionCompleteButton');
        const badgesGallery = document.getElementById('badgesGallery');

        let currentMissionIndex = -1;
        let completedBadges = JSON.parse(localStorage.getItem('jadeBadges')) || [];

        function displayRandomMission() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * missions.length);
            } while (newIndex === currentMissionIndex && missions.length > 1); // Évite de répéter la même mission si possible
            currentMissionIndex = newIndex;
            currentMissionDisplay.textContent = missions[currentMissionIndex];
            missionCompleteButton.style.display = 'inline-block'; // Afficher le bouton "Accomplie"
            newMissionButton.textContent = 'Nouvelle Mission ✨'; // Changer le texte du bouton
            showCustomDialog("Nouvelle Mission !", missions[currentMissionIndex], 'alert');
        }

        function addBadge() {
            const badge = '🎖️'; // Ou '👑'
            completedBadges.push(badge);
            localStorage.setItem('jadeBadges', JSON.stringify(completedBadges));
            renderBadges();
            showCustomDialog("Super Héro !", "Bravo Jade, tu as accompli une mission ! Voici ton nouveau badge !", 'alert');
        }

        function renderBadges() {
            badgesGallery.innerHTML = ''; // Vide la galerie avant de la remplir
            completedBadges.forEach((badge, index) => {
                const span = document.createElement('span');
                span.className = 'badge';
                span.textContent = badge;
                span.style.setProperty('--delay', `${index * 0.1}s`);
                badgesGallery.appendChild(span);
            });
        }

        newMissionButton.addEventListener('click', displayRandomMission);
        missionCompleteButton.addEventListener('click', () => {
            addBadge();
            currentMissionDisplay.textContent = "Super ! Trouve une nouvelle mission !";
            missionCompleteButton.style.display = 'none'; // Cacher le bouton "Accomplie"
            newMissionButton.textContent = 'Nouvelle Mission ✨'; // Revenir au texte initial
        });


        // --- Zone de Récompense de Jade ---
        const rewardGallery = document.getElementById('rewardGallery');
        const rewardQuoteElement = document.getElementById('rewardQuote');
        const printWeekButton = document.getElementById('printWeekButton');

        const magicQuotes = [
            "Même une bouchée, c'est un pas de géant dans un royaume invisible !",
            "Chaque nouvelle découverte est une étoile qui brille dans ton cœur !",
            "Tu es courageuse, petite exploratrice des saveurs ! Le monde des goûters t'attend !",
            "Ton cerveau est comme un jardin secret, et chaque nouvelle chose que tu goûtes, c'est une jolie fleur qui pousse !",
            "Regarde comme tu grandis ! Chaque petite victoire te rend plus forte et plus aventureuse !",
            "Chaque petite bouchée te fait voyager dans un monde de saveurs !",
            "Ton courage est une lumière qui guide Croquilou vers de nouvelles découvertes !",
            "Tu es une championne des papilles, et chaque jour te rapproche de la grande aventure du goût !",
            "Ne l'oublie jamais : tu es capable de grandes choses, surtout quand il s'agit d'explorer de nouveaux goûters !",
            "Chaque aliment est un ami qui t'apporte de l'énergie et de la joie !",
            "Les goûters sont des aventures ! Chaque fois que tu essaies, tu es une héroïne !",
            "Ton corps te remercie pour chaque nouvelle découverte culinaire !"
        ];

        function updateRewardGallery() {
            rewardGallery.innerHTML = '';
            let totalActiveCells = 0;
            progressTable.querySelectorAll('tbody button.active').forEach((button) => {
                totalActiveCells++;
                const rewardItem = document.createElement('div');
                rewardItem.className = 'reward-item';
                rewardItem.innerHTML = `<span class="emoji">${button.innerHTML}</span>`;
                rewardGallery.appendChild(rewardItem);
            });

            // Afficher une citation magique aléatoire
            if (totalActiveCells > 0) {
                const randomQuote = magicQuotes[Math.floor(Math.random() * magicQuotes.length)];
                rewardQuoteElement.textContent = randomQuote;
            } else {
                rewardQuoteElement.textContent = "Termine des missions pour débloquer des citations magiques !";
            }
        }

        printWeekButton.addEventListener('click', () => {
            showCustomDialog("Imprimer ta semaine", "Tu peux maintenant imprimer cette page depuis les options de ton navigateur (Ctrl+P ou Cmd+P) et choisir 'Enregistrer en PDF' pour garder une trace de tes super réussites !", 'alert');
            // window.print(); // Décommentez ceci pour un déclenchement direct de l'impression
        });

        // --- Section Morgane : Bouton Télécharger PDF (Placeholder) ---
        const downloadPdfButton = document.getElementById('downloadPdfButton');
        downloadPdfButton.addEventListener('click', () => {
            showCustomDialog("Téléchargement du Guide", "Pour télécharger le guide, utilisez la fonction d'impression de votre navigateur (Ctrl+P ou Cmd+P) et sélectionnez 'Enregistrer en PDF'.", 'alert');
        });

        // --- Initialisation à l'ouverture de la page ---
        window.onload = () => {
            animateCatchphrase();
            loadProgress();
            renderBadges();
            updateRewardGallery(); // Assure que la galerie de récompenses est à jour dès le chargement

            // Au chargement, par défaut, affiche le contenu Jade
            hideAllContentSections();
            jadeContent.classList.add('active');
        };
    </script>
</body>
</html>
�